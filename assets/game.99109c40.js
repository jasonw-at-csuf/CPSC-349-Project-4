import{j as e,A as T,b as j,R as C,r as u,c as b,d as x,i as w,a as c,e as X}from"./index.cc80b2e2.js";function _(n){var l=n.replace(/\s+/gm," "),r=l.split(" ").filter(s=>s!=="false"&&s!=="true"&&s!=="undefined").join(" ").trim();return r}function E({children:n,onClick:l}){const r=_(`flex
    justify-center
    items-center
    m-2
    bg-white
    text-3xl
    w-28
    h-28
    outline
    rounded
    btn-square
    outline-amber-900
    hover:outline-amber-900
    hover:outline-8`);return e("button",{className:r,onClick:l,children:n})}const o=new T("https://cpsc349project4.fly.dev");o.autoCancellation(!1);const m=new URLSearchParams(window.location.search).get("gameId");function G(){const[n,l]=u.exports.useState(b(3)),[r,s]=u.exports.useState("X"),[g,h]=u.exports.useState(null),N=(t,a,i)=>{let d=[...n];return d[t][a]=i,l(d),d},y=()=>{const t=r=="O"?"X":"O";return s(t),t},S=async(t,a)=>{const i=await p();if(!(r=="X"&&i.player_1[0]!=o.authStore.model.id)&&!(r=="O"&&i.player_2[0]!=o.authStore.model.id)&&!w(n)&&g==null&&!n[t][a]){const d=N(t,a,r),O=y();await f(d,O)}},v=async()=>{s("X"),h(null),l(b(3)),await f(b(3),"X")},f=async(t,a)=>{await o.collection("games").update(m,{turn:a,board_state:JSON.stringify(t)})},p=async()=>await o.collection("games").getOne(m);return u.exports.useEffect(()=>{p().then(t=>{l(JSON.parse(t.board_state)),s(t.turn),t.player_1[0]!=o.authStore.model.id&&t.player_2[0]!=o.authStore.model.id&&(window.location.href="../")}),o.collection("games").subscribe(m,function(t){l(JSON.parse(t.record.board_state)),s(t.record.turn)})},[]),u.exports.useEffect(()=>{const t=x(n);h(x(n)),t?alert(`${t} is the winner`):w(n)&&alert("Tie")},[n]),e("div",{className:"flex justify-center items-center content-center h-screen bg-cyan-700",children:c("div",{className:"bg-amber-100 outline outline-amber-900 outline-8 text-center w-5/6 sm:w-2/3",children:[e("div",{className:"flex justify-center content-center",children:c("div",{className:"w-64 grid grid-cols-3 gap-2 grid-rows-3 m-4",children:[e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"TIC"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"X"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"O"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"O"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"TAC"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"X"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"X"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"O"}),e("p",{className:"outline outline-amber-900 rounded font-bold text-3xl",children:"TOE"})]})}),e("br",{}),c("div",{className:"flex flex-col items-center",children:[c("p",{className:"text-m font-bold outline rounded outline-amber-900 w-64 m-1",children:["Authenticated as: ",o.authStore.model.name]}),e("p",{className:"text-m font-bold outline rounded outline-amber-900 w-64 m-1",children:"Tap a box to start the game"}),c("p",{className:"text-m font-bold outline rounded outline-amber-900 w-64 m-1",children:["Current Player: ",e("span",{id:"currentPlayer",children:r})]}),c("p",{className:"text-m font-bold outline rounded outline-amber-900 w-64 m-1",children:["Join Code: ",e("span",{id:"gameId",children:m})]})]}),e("div",{className:"flex justify-center",children:e("div",{id:"game-grid",className:"grid grid-cols-3 w-96 content-center",children:[...Array(9).keys()].map(t=>{const[a,i]=X(t);return e(E,{onClick:()=>{S(a,i)},children:n[a][i]},t)})})}),e("br",{}),e("button",{id:"but",className:"bg-white hover:bg-amber-900 text-amber-900 font-semibold hover:text-white py-2 px-4 border border-amber-900 hover:border-transparent rounded",onClick:async()=>{await v()},children:"RESET"}),e("br",{}),e("br",{}),e("p",{id:"DisplayMessage"})]})})}j.createRoot(document.getElementById("root")).render(e(C.StrictMode,{children:e(G,{})}));
